<!DOCTYPE html>
<html>
<head>
  <meta charset="UTF-8">
  <title>NFC Redirect</title>
</head>
<body>
  <p>ğŸ”„ è½‰å€ä¸­ï¼Œè«‹ç¨å€™...</p>
  <script>
    const id = new URLSearchParams(window.location.search).get("id");
    const sheetUrl = "https://docs.google.com/spreadsheets/d/e/2PACX-1vRLmgY4rFS7K6InfaiO837OfhejcmixjJT-W6z4-zmxeofutmOKCMhTSbQHhxBLlgl_mpJ16jZ1-P87/pub?output=csv";
    const activeCol = 2; // å°æ‡‰ Link1ï¼ˆindex 2ï¼‰

    fetch(sheetUrl)
      .then(res => res.text())
      .then(text => {
        const rows = text.trim().split("\n").map(row => row.split(","));

        // ç§»é™¤ BOMï¼ˆåªè™•ç†ç¬¬ä¸€åˆ—ç¬¬ä¸€æ¬„ï¼‰
        if (rows[0][0].charCodeAt(0) === 0xFEFF) {
          rows[0][0] = rows[0][0].substring(1);
        }

        const header = rows[0];
        const data = rows.slice(1);
        const dataRow = data.find(row => row[0].trim() === id.trim());

        if (dataRow && dataRow[activeCol]) {
          window.location.href = dataRow[activeCol];
        } else {
          document.body.innerHTML = "âŒ æ‰¾ä¸åˆ°å°æ‡‰è³‡æ–™æˆ–é€£çµç‚ºç©º";
        }
      })
      .catch(err => {
        document.body.innerHTML = "âš ï¸ ç„¡æ³•è¼‰å…¥è³‡æ–™ï¼š" + err;
      });
  </script>
</body>
</html>
