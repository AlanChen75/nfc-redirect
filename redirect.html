<!DOCTYPE html>
<html>
<head>
  <meta charset="UTF-8">
  <title>NFC Redirect</title>
</head>
<body>
  <p>ğŸ”„ è½‰å€ä¸­ï¼Œè«‹ç¨å€™...</p>
  <script>
    const id = new URLSearchParams(window.location.search).get("id");
    const sheetID = "1YUaLm1kp87H8OGgCTkv6Hz_XqnXgJqEBSuUvGOjY9FQ";  // ä½ çš„ Google Sheet ID
    const sheetName = "é€£çµè¡¨"; // å·¥ä½œè¡¨åç¨±
    const activeCol = 2; // Link1 å°æ‡‰ index = 2

    const url = `https://docs.google.com/spreadsheets/d/${sheetID}/gviz/tq?tqx=out:json&sheet=${sheetName}`;

    fetch(url)
      .then(res => res.text())
      .then(text => {
        // ç§»é™¤ä¸å¿…è¦çš„å‰ç¶´èˆ‡å¾Œç¶´å–å¾— JSON
        const json = JSON.parse(text.substr(47).slice(0, -2));
        const rows = json.table.rows;

        const data = rows.map(r => r.c.map(c => (c ? c.v : "")));

        const dataRow = data.find(row => row[0] === id);

        if (dataRow && dataRow[activeCol]) {
          window.location.href = dataRow[activeCol];
        } else {
          document.body.innerHTML = "âŒ æ‰¾ä¸åˆ°å°æ‡‰è³‡æ–™æˆ–ç¶²å€ç‚ºç©º";
        }
      })
      .catch(err => {
        document.body.innerHTML = "âš ï¸ ç„¡æ³•è®€å– Google Sheetï¼š" + err;
      });
  </script>
</body>
</html>
